!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports._vantaEffect=e():t._vantaEffect=e()}("undefined"!=typeof self?self:this,(()=>(()=>{"use strict";var t={294:(t,e,i)=>{i.d(e,{Z:()=>l,o:()=>r});var o=i(201);const n="object"==typeof window;let s=n&&window.THREE||{};n&&!window.VANTA&&(window.VANTA={});const r=n&&window.VANTA||{};r.register=(t,e)=>r[t]=t=>new e(t),r.version="0.5.24";const a=(...t)=>{console.error("[VANTA]",...t)};class l{constructor(t={}){if(!n)return;r.current=this,this.windowMouseMoveWrapper=this.windowMouseMoveWrapper.bind(this),this.windowTouchWrapper=this.windowTouchWrapper.bind(this),this.windowGyroWrapper=this.windowGyroWrapper.bind(this),this.resize=this.resize.bind(this),this.animationLoop=this.animationLoop.bind(this),this.restart=this.restart.bind(this);const e="function"==typeof this.getDefaultOptions?this.getDefaultOptions():this.defaultOptions;this.options=Object.assign({mouseControls:!0,touchControls:!0,gyroControls:!1,minHeight:200,minWidth:200,scale:1,scaleMobile:1},e||{});let i=t;if((t instanceof HTMLElement||"string"==typeof t)&&(i={el:t}),Object.assign(this.options,i),this.options.THREE&&(s=this.options.THREE),this.el=this.options.el,null==this.el)return void a('Instance needs "el" param!');if(!(this.options.el instanceof HTMLElement)){const t=this.el;if(this.el=(0,o.q)(t),!this.el)return void a("Cannot find element",t)}this.prepareEl(),this.initThree(),this.setSize();try{this.init()}catch(t){return a("Init error",t),this.renderer?.domElement&&this.el.removeChild(this.renderer.domElement),void(this.options.backgroundColor&&(console.log("[VANTA] Falling back to backgroundColor"),this.el.style.background=(0,o.pj)(this.options.backgroundColor)))}this.initMouse(),this.resize(),this.animationLoop();const l=window.addEventListener.bind(window);l("resize",this.resize),window.requestAnimationFrame(this.resize),this.options.mouseControls&&(l("scroll",this.windowMouseMoveWrapper),l("mousemove",this.windowMouseMoveWrapper)),this.options.touchControls&&(l("touchstart",this.windowTouchWrapper),l("touchmove",this.windowTouchWrapper)),this.options.gyroControls&&l("deviceorientation",this.windowGyroWrapper)}setOptions(t={}){Object.assign(this.options,t),this.triggerMouseMove()}prepareEl(){let t,e;if("undefined"!=typeof Node&&Node.TEXT_NODE)for(t=0;t<this.el.childNodes.length;t++){const e=this.el.childNodes[t];if(e.nodeType===Node.TEXT_NODE){const t=document.createElement("span");t.textContent=e.textContent,e.parentElement.insertBefore(t,e),e.remove()}}for(t=0;t<this.el.children.length;t++)e=this.el.children[t],"static"===getComputedStyle(e).position&&(e.style.position="relative"),"auto"===getComputedStyle(e).zIndex&&(e.style.zIndex="1");"static"===getComputedStyle(this.el).position&&(this.el.style.position="relative")}applyCanvasStyles(t,e={}){Object.assign(t.style,{position:"absolute",zIndex:0,top:0,left:0,background:""}),this.options.pixelated&&(t.style.imageRendering="pixelated"),Object.assign(t.style,e),t.classList.add("vanta-canvas")}initThree(){s.WebGLRenderer?(this.renderer=new s.WebGLRenderer({alpha:!0,antialias:!0}),this.el.appendChild(this.renderer.domElement),this.applyCanvasStyles(this.renderer.domElement),isNaN(this.options.backgroundAlpha)&&(this.options.backgroundAlpha=1),this.scene=new s.Scene):console.warn("[VANTA] No THREE defined on window")}getCanvasElement(){return this.renderer?this.renderer.domElement:this.p5renderer?this.p5renderer.canvas:void 0}getCanvasRect(){const t=this.getCanvasElement();return!!t&&t.getBoundingClientRect()}windowMouseMoveWrapper(t){const e=this.getCanvasRect();if(!e)return;const i=t.clientX-e.left,o=t.clientY-e.top;i>=0&&o>=0&&i<=e.width&&o<=e.height&&(this.mouseX=i,this.mouseY=o,this.options.mouseEase||this.triggerMouseMove(i,o))}windowTouchWrapper(t){const e=this.getCanvasRect();if(e&&1===t.touches.length){const i=t.touches[0].clientX-e.left,o=t.touches[0].clientY-e.top;i>=0&&o>=0&&i<=e.width&&o<=e.height&&(this.mouseX=i,this.mouseY=o,this.options.mouseEase||this.triggerMouseMove(i,o))}}windowGyroWrapper(t){const e=this.getCanvasRect();if(!e)return;const i=Math.round(2*(t.alpha??0))-e.left,o=Math.round(2*(t.beta??0))-e.top;i>=0&&o>=0&&i<=e.width&&o<=e.height&&(this.mouseX=i,this.mouseY=o,this.options.mouseEase||this.triggerMouseMove(i,o))}triggerMouseMove(t,e){void 0===t&&void 0===e&&(this.options.mouseEase?(t=this.mouseEaseX??0,e=this.mouseEaseY??0):(t=this.mouseX,e=this.mouseY)),this.uniforms?.iMouse?.value&&"object"==typeof this.uniforms.iMouse.value&&(this.uniforms.iMouse.value.x=(t??0)/this.scale,this.uniforms.iMouse.value.y=(e??0)/this.scale);const i=(t??0)/this.width,o=(e??0)/this.height;"function"==typeof this.onMouseMove&&this.onMouseMove(i,o)}setSize(){this.scale=this.scale||1,(0,o.KU)()&&this.options.scaleMobile?this.scale=this.options.scaleMobile:this.options.scale&&(this.scale=this.options.scale),this.width=Math.max(this.el.offsetWidth,this.options.minWidth??200),this.height=Math.max(this.el.offsetHeight,this.options.minHeight??200)}initMouse(){const t=this.options.minWidth??200,e=this.options.minHeight??200;(null==this.mouseX&&null==this.mouseY||this.mouseX===t/2&&this.mouseY===e/2)&&(this.mouseX=this.width/2,this.mouseY=this.height/2,this.triggerMouseMove(this.mouseX,this.mouseY))}resize(){this.setSize(),this.camera&&(this.camera.aspect=this.width/this.height,"function"==typeof this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix()),this.renderer&&(this.renderer.setSize(this.width,this.height),this.renderer.setPixelRatio(window.devicePixelRatio/this.scale)),"function"==typeof this.onResize&&this.onResize()}isOnScreen(){const t=this.el.offsetHeight,e=this.el.getBoundingClientRect(),i=window.pageYOffset??(document.documentElement||document.body.parentNode||document.body).scrollTop,o=e.top+i;return o-window.innerHeight<=i&&i<=o+t}animationLoop(){this.t=this.t??0,this.t2=this.t2??0;const t=performance.now();if(this.prevNow){let e=(t-this.prevNow)/(1e3/60);e=Math.max(.2,Math.min(e,5)),this.t+=e,this.t2+=(this.options.speed||1)*e,void 0!==this.uniforms?.iTime?.value&&(this.uniforms.iTime.value=.016667*this.t2)}return this.prevNow=t,this.options.mouseEase&&(this.mouseEaseX=this.mouseEaseX??this.mouseX??0,this.mouseEaseY=this.mouseEaseY??this.mouseY??0,Math.abs(this.mouseEaseX-this.mouseX)+Math.abs(this.mouseEaseY-this.mouseY)>.1&&(this.mouseEaseX+=.05*(this.mouseX-this.mouseEaseX),this.mouseEaseY+=.05*(this.mouseY-this.mouseEaseY),this.triggerMouseMove(this.mouseEaseX,this.mouseEaseY))),(this.isOnScreen()||this.options.forceAnimate)&&("function"==typeof this.onUpdate&&this.onUpdate(),this.scene&&this.camera&&this.renderer&&(this.renderer.render(this.scene,this.camera),this.renderer.setClearColor(this.options.backgroundColor,this.options.backgroundAlpha)),this.fps?.update&&this.fps.update(),"function"==typeof this.afterRender&&this.afterRender()),this.req=window.requestAnimationFrame(this.animationLoop.bind(this))}restart(){if(this.scene&&this.scene.children){const t=this.scene;for(;t.children.length;)t.remove(t.children[0])}"function"==typeof this.onRestart&&this.onRestart(),this.init()}init(){"function"==typeof this.onInit&&this.onInit()}destroy(){"function"==typeof this.onDestroy&&this.onDestroy();const t=window.removeEventListener.bind(window);t("touchstart",this.windowTouchWrapper),t("touchmove",this.windowTouchWrapper),t("scroll",this.windowMouseMoveWrapper),t("mousemove",this.windowMouseMoveWrapper),t("deviceorientation",this.windowGyroWrapper),t("resize",this.resize),null!=this.req&&window.cancelAnimationFrame(this.req);const e=this.scene;e?.children&&(0,o.Wd)(e),this.renderer&&(this.renderer.domElement?.parentNode&&this.el.removeChild(this.renderer.domElement),this.renderer=void 0,this.scene=void 0),r.current===this&&(r.current=null)}}r.VantaBase=l},201:(t,e,i)=>{function o(){return"undefined"!=typeof navigator?/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<600:null}i.d(e,{KU:()=>o,Wd:()=>r,pj:()=>s,q:()=>n}),Number.prototype.clamp=function(t,e){return Math.min(Math.max(Number(this),t),e)};const n=t=>document.querySelector(t),s=t=>"number"==typeof t?"#"+("00000"+t.toString(16)).slice(-6):t;function r(t){for(;t.children&&t.children.length>0;)r(t.children[0]),t.remove(t.children[0]);t.geometry&&t.geometry.dispose(),t.material&&(Object.keys(t.material).forEach((e=>{const i=t.material[e];i&&null!==i&&"function"==typeof i.dispose&&i.dispose()})),"function"==typeof t.material.dispose&&t.material.dispose())}}},e={};function i(o){var n=e[o];if(void 0!==n)return n.exports;var s=e[o]={exports:{}};return t[o](s,s.exports,i),s.exports}i.d=(t,e)=>{for(var o in e)i.o(e,o)&&!i.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var o={};return(()=>{i.r(o),i.d(o,{default:()=>f});var t=i(294),e=i(201);let n="object"==typeof window&&window.THREE;class s{constructor(t,e,i,o){o&&(n=o),this.variables=[],this.currentTextureIndex=0;let s=n.FloatType;const r=new n.Scene,a=new n.Camera;a.position.z=1;const l={passThruTexture:{value:null}},h=u("uniform sampler2D passThruTexture;\n\nvoid main() {\n\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n\n\tgl_FragColor = texture2D( passThruTexture, uv );\n\n}\n",l),d=new n.Mesh(new n.PlaneGeometry(2,2),h);function c(i){i.defines.resolution="vec2( "+t.toFixed(1)+", "+e.toFixed(1)+" )"}function u(t,e){e=e||{};const i=new n.ShaderMaterial({uniforms:e,vertexShader:"void main()\t{\n\n\tgl_Position = vec4( position, 1.0 );\n\n}\n",fragmentShader:t});return c(i),i}r.add(d),this.setDataType=function(t){return s=t,this},this.addVariable=function(t,e,i){const o={name:t,initialValueTexture:i,material:this.createShaderMaterial(e),dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:n.NearestFilter,magFilter:n.NearestFilter};return this.variables.push(o),o},this.setVariableDependencies=function(t,e){t.dependencies=e},this.init=function(){if(!1===i.capabilities.isWebGL2&&!1===i.extensions.has("OES_texture_float"))return"No OES_texture_float support for float textures.";if(0===i.capabilities.maxVertexTextures)return"No support for vertex shader textures.";for(let i=0;i<this.variables.length;i++){const o=this.variables[i];o.renderTargets[0]=this.createRenderTarget(t,e,o.wrapS,o.wrapT,o.minFilter,o.magFilter),o.renderTargets[1]=this.createRenderTarget(t,e,o.wrapS,o.wrapT,o.minFilter,o.magFilter),this.renderTexture(o.initialValueTexture,o.renderTargets[0]),this.renderTexture(o.initialValueTexture,o.renderTargets[1]);const n=o.material,s=n.uniforms;if(null!==o.dependencies)for(let t=0;t<o.dependencies.length;t++){const e=o.dependencies[t];if(e.name!==o.name){let t=!1;for(let i=0;i<this.variables.length;i++)if(e.name===this.variables[i].name){t=!0;break}if(!t)return"Variable dependency not found. Variable="+o.name+", dependency="+e.name}s[e.name]={value:null},n.fragmentShader="\nuniform sampler2D "+e.name+";\n"+n.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){const t=this.currentTextureIndex,e=0===this.currentTextureIndex?1:0;for(let i=0,o=this.variables.length;i<o;i++){const o=this.variables[i];if(null!==o.dependencies){const e=o.material.uniforms;for(let i=0,n=o.dependencies.length;i<n;i++){const n=o.dependencies[i];e[n.name].value=n.renderTargets[t].texture}}this.doRenderTarget(o.material,o.renderTargets[e])}this.currentTextureIndex=e},this.getCurrentRenderTarget=function(t){return t.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(t){return t.renderTargets[0===this.currentTextureIndex?1:0]},this.dispose=function(){d.geometry.dispose(),d.material.dispose();const t=this.variables;for(let e=0;e<t.length;e++){const i=t[e];i.initialValueTexture?.dispose();const o=i.renderTargets;for(let t=0;t<o.length;t++)o[t].dispose()}},this.addResolutionDefine=c,this.createShaderMaterial=u,this.createRenderTarget=function(i,o,r,a,l,h){return i=i||t,o=o||e,r=r||n.ClampToEdgeWrapping,a=a||n.ClampToEdgeWrapping,l=l||n.NearestFilter,h=h||n.NearestFilter,new n.WebGLRenderTarget(i,o,{wrapS:r,wrapT:a,minFilter:l,magFilter:h,format:n.RGBAFormat,type:s,depthBuffer:!1})},this.createTexture=function(){const i=new Float32Array(t*e*4),o=new n.DataTexture(i,t,e,n.RGBAFormat,n.FloatType);return o.needsUpdate=!0,o},this.renderTexture=function(t,e){l.passThruTexture.value=t,this.doRenderTarget(h,e),l.passThruTexture.value=null},this.doRenderTarget=function(t,e){const o=i.getRenderTarget(),s=i.xr.enabled,l=i.shadowMap.autoUpdate,c=i.outputEncoding,u=i.toneMapping;i.xr.enabled=!1,i.shadowMap.autoUpdate=!1,i.outputEncoding=n.LinearEncoding,i.toneMapping=n.NoToneMapping,d.material=t,i.setRenderTarget(e),i.render(r,a),d.material=h,i.xr.enabled=s,i.shadowMap.autoUpdate=l,i.outputEncoding=c,i.toneMapping=u,i.setRenderTarget(o)}}}n.GPUComputationRenderer=s;const r=s;let a="object"==typeof window&&window.THREE;const l=!(0,e.KU)();let h=32,d=h*h;const c=800,u=(t={})=>{const e=new a.BufferGeometry,i=[];function o(e,o,n){const s=1.5*(t.birdSize||1);i.push(new a.Vector3(e*s,o*s,n*s))}o(5,0,0),o(-5,-1,1),o(-5,0,0),o(-5,-2,-1),o(0,2,-6),o(0,2,6),o(2,0,0),o(-3,0,0),e.setFromPoints(i);const n=[];return n.push(0,2,1),n.push(4,7,6),n.push(5,6,7),e.setIndex(n),e};class p{constructor(t){var e,i,o=new a.Vector3,n=500,s=500,r=200,l=.1,h=t;this.position=new a.Vector3,this.velocity=new a.Vector3,e=new a.Vector3,this.setGoal=function(t){i=t},this.setWorldSize=function(t,e,i){n=t,s=e,r=i},this.run=function(t){o.set(-n,this.position.y,this.position.z),(o=this.avoid(o)).multiplyScalar(5),e.add(o),o.set(n,this.position.y,this.position.z),(o=this.avoid(o)).multiplyScalar(5),e.add(o),o.set(this.position.x,-s,this.position.z),(o=this.avoid(o)).multiplyScalar(5),e.add(o),o.set(this.position.x,s,this.position.z),(o=this.avoid(o)).multiplyScalar(5),e.add(o),o.set(this.position.x,this.position.y,-r),(o=this.avoid(o)).multiplyScalar(5),e.add(o),o.set(this.position.x,this.position.y,r),(o=this.avoid(o)).multiplyScalar(5),e.add(o),Math.random()>.5&&this.flock(t),this.move()},this.flock=function(t){i&&e.add(this.reach(i,.005)),e.add(this.alignment(t)),e.add(this.cohesion(t)),e.add(this.separation(t))},this.move=function(){this.velocity.add(e);var t=this.velocity.length();t>2.5&&this.velocity.divideScalar(t/2.5),this.position.add(this.velocity),e.set(0,0,0)},this.checkBounds=function(){this.position.x>n&&(this.position.x=-n),this.position.x<-n&&(this.position.x=n),this.position.y>s&&(this.position.y=-s),this.position.y<-s&&(this.position.y=s),this.position.z>r&&(this.position.z=-r),this.position.z<-r&&(this.position.z=r)},this.avoid=function(t){var e=new a.Vector3;return e.copy(this.position),e.sub(t),e.multiplyScalar(1/this.position.distanceToSquared(t)),e},this.repulse=function(t){var i=this.position.distanceTo(t);if(i<150){var o=new a.Vector3;o.subVectors(this.position,t),o.multiplyScalar(.5/i),e.add(o)}},this.reach=function(t,e){var i=new a.Vector3;return i.subVectors(t,this.position),i.multiplyScalar(e),i},this.alignment=function(t){var e,i,o=new a.Vector3,n=0;const s=100*h.alignment/20;for(var r=0,d=t.length;r<d;r++)Math.random()>.6||(i=(e=t[r]).position.distanceTo(this.position))>0&&i<=s&&(o.add(e.velocity),n++);if(n>0){o.divideScalar(n);var c=o.length();c>l&&o.divideScalar(c/l)}return o},this.cohesion=function(t){var e,i,o=new a.Vector3,n=new a.Vector3,s=0;const r=100*h.cohesion/20;for(var d=0,c=t.length;d<c;d++)Math.random()>.6||(i=(e=t[d]).position.distanceTo(this.position))>0&&i<=r&&(o.add(e.position),s++);s>0&&o.divideScalar(s),n.subVectors(o,this.position);var u=n.length();return u>l&&n.divideScalar(u/l),n},this.separation=function(t){var e,i,o=new a.Vector3,n=new a.Vector3;const s=100*h.separation/20;for(var r=0,l=t.length;r<l;r++)Math.random()>.6||(i=(e=t[r]).position.distanceTo(this.position))>0&&i<=s&&(n.subVectors(this.position,e.position),n.normalize(),n.divideScalar(i),o.add(n));return o}}}class m extends t.Z{static initClass(){this.prototype.defaultOptions={backgroundColor:465199,color1:16711680,color2:53759,colorMode:"varianceGradient",birdSize:1,wingSpan:30,speedLimit:5,separation:20,alignment:20,cohesion:20,quantity:5}}constructor(t){a=t.THREE||a,super(t)}initComputeRenderer(){this.gpuCompute=new r(h,h,this.renderer,a),!1===this.renderer.capabilities.isWebGL2&&gpuCompute.setDataType(a.HalfFloatType);const t=this.gpuCompute.createTexture(),e=this.gpuCompute.createTexture();!function(t){const e=t.image.data;let i=0;const o=e.length;(()=>{const t=[];for(;i<o;){const o=Math.random()*c-400,n=Math.random()*c-400,s=Math.random()*c-400;e[i+0]=o,e[i+1]=n,e[i+2]=s,e[i+3]=1,t.push(i+=4)}})()}(t),function(t){const e=t.image.data;let i=0;const o=e.length;(()=>{const t=[];for(;i<o;){const o=Math.random()-.5,n=Math.random()-.5,s=Math.random()-.5;e[i+0]=10*o,e[i+1]=10*n,e[i+2]=10*s,e[i+3]=1,t.push(i+=4)}})()}(e),this.velocityVariable=this.gpuCompute.addVariable("textureVelocity","uniform float time;\nuniform float testing;\nuniform float delta; // about 0.016\nuniform float separationDistance; // 20\nuniform float alignmentDistance; // 40\nuniform float cohesionDistance;\nuniform float speedLimit;\nuniform float freedomFactor;\nuniform vec3 predator;\n\nconst float width = resolution.x;\nconst float height = resolution.y;\n\nconst float PI = 3.141592653589793;\nconst float PI_2 = PI * 2.0;\n// const float VISION = PI * 0.55;\n\nfloat zoneRadius = 40.0;\nfloat zoneRadiusSquared = 1600.0;\n\nfloat separationThresh = 0.45;\nfloat alignmentThresh = 0.65;\n\nconst float UPPER_BOUNDS = BOUNDS;\nconst float LOWER_BOUNDS = -UPPER_BOUNDS;\n\nfloat rand(vec2 co){\n  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);\n}\n\nvoid main() {\n\n  zoneRadius = separationDistance + alignmentDistance + cohesionDistance;\n  separationThresh = separationDistance / zoneRadius;\n  alignmentThresh = ( separationDistance + alignmentDistance ) / zoneRadius;\n  zoneRadiusSquared = zoneRadius * zoneRadius;\n\n\n  vec2 uv = gl_FragCoord.xy / resolution.xy;\n  vec3 birdPosition, birdVelocity;\n\n  vec3 selfPosition = texture2D( texturePosition, uv ).xyz;\n  vec3 selfVelocity = texture2D( textureVelocity, uv ).xyz;\n\n  float dist;\n  vec3 dir; // direction\n  float distSquared;\n\n  float separationSquared = separationDistance * separationDistance;\n  float cohesionSquared = cohesionDistance * cohesionDistance;\n\n  float f;\n  float percent;\n\n  vec3 velocity = selfVelocity;\n\n  float limit = speedLimit;\n\n  dir = predator * UPPER_BOUNDS - selfPosition;\n  dir.z = 0.;\n  // dir.z *= 0.6;\n  dist = length( dir );\n  distSquared = dist * dist;\n\n  float preyRadius = 150.0;\n  float preyRadiusSq = preyRadius * preyRadius;\n\n  // move birds away from predator\n  if (dist < preyRadius) {\n\n    f = ( distSquared / preyRadiusSq - 1.0 ) * delta * 100.;\n    velocity += normalize( dir ) * f;\n    limit += 5.0;\n  }\n\n  // if (testing == 0.0) {}\n  // if ( rand( uv + time ) < freedomFactor ) {}\n\n  // Attract flocks to the center\n  vec3 central = vec3( 0., 0., 0. );\n  dir = selfPosition - central;\n  dist = length( dir );\n\n  dir.y *= 2.5;\n  velocity -= normalize( dir ) * delta * 5.;\n\n  for (float y=0.0;y<height;y++) {\n    for (float x=0.0;x<width;x++) {\n\n      vec2 ref = vec2( x + 0.5, y + 0.5 ) / resolution.xy;\n      birdPosition = texture2D( texturePosition, ref ).xyz;\n\n      dir = birdPosition - selfPosition;\n      dist = length(dir);\n\n      if (dist < 0.0001) continue;\n\n      distSquared = dist * dist;\n\n      if (distSquared > zoneRadiusSquared ) continue;\n\n      percent = distSquared / zoneRadiusSquared;\n\n      if ( percent < separationThresh ) { // low\n\n        // Separation - Move apart for comfort\n        f = (separationThresh / percent - 1.0) * delta;\n        velocity -= normalize(dir) * f;\n\n      } else if ( percent < alignmentThresh ) { // high\n\n        // Alignment - fly the same direction\n        float threshDelta = alignmentThresh - separationThresh;\n        float adjustedPercent = ( percent - separationThresh ) / threshDelta;\n\n        birdVelocity = texture2D( textureVelocity, ref ).xyz;\n\n        f = ( 0.5 - cos( adjustedPercent * PI_2 ) * 0.5 + 0.5 ) * delta;\n        velocity += normalize(birdVelocity) * f;\n\n      } else {\n\n        // Attraction / Cohesion - move closer\n        float threshDelta = 1.0 - alignmentThresh;\n        float adjustedPercent = ( percent - alignmentThresh ) / threshDelta;\n\n        f = ( 0.5 - ( cos( adjustedPercent * PI_2 ) * -0.5 + 0.5 ) ) * delta;\n\n        velocity += normalize(dir) * f;\n\n      }\n    }\n  }\n\n  // this make tends to fly around than down or up\n  // if (velocity.y > 0.) velocity.y *= (1. - 0.2 * delta);\n\n  // Speed Limits\n  if ( length( velocity ) > limit ) {\n    velocity = normalize( velocity ) * limit;\n  }\n\n  gl_FragColor = vec4( velocity, 1.0 );\n\n}",e),this.positionVariable=this.gpuCompute.addVariable("texturePosition","uniform float time;\nuniform float delta;\n\nvoid main() {\n\n  vec2 uv = gl_FragCoord.xy / resolution.xy;\n  vec4 tmpPos = texture2D( texturePosition, uv );\n  vec3 position = tmpPos.xyz;\n  vec3 velocity = texture2D( textureVelocity, uv ).xyz;\n\n  float phase = tmpPos.w;\n\n  phase = mod( ( phase + delta +\n    length( velocity.xz ) * delta * 3. +\n    max( velocity.y, 0.0 ) * delta * 6. ), 62.83 );\n\n  gl_FragColor = vec4( position + velocity * delta * 15. , phase );\n\n}",t),this.gpuCompute.setVariableDependencies(this.velocityVariable,[this.positionVariable,this.velocityVariable]),this.gpuCompute.setVariableDependencies(this.positionVariable,[this.positionVariable,this.velocityVariable]),this.positionUniforms=this.positionVariable.material.uniforms,this.velocityUniforms=this.velocityVariable.material.uniforms,this.positionUniforms.time={value:0},this.positionUniforms.delta={value:0},this.velocityUniforms.time={value:1},this.velocityUniforms.delta={value:0},this.velocityUniforms.testing={value:1},this.velocityUniforms.separationDistance={value:1},this.velocityUniforms.alignmentDistance={value:1},this.velocityUniforms.cohesionDistance={value:1},this.velocityUniforms.speedLimit={value:1},this.velocityUniforms.freedomFactor={value:1},this.velocityUniforms.predator={value:new a.Vector3},this.velocityVariable.material.defines.BOUNDS=c.toFixed(2),this.velocityVariable.wrapS=a.RepeatWrapping,this.velocityVariable.wrapT=a.RepeatWrapping,this.positionVariable.wrapS=a.RepeatWrapping,this.positionVariable.wrapT=a.RepeatWrapping;const i=this.gpuCompute.init();null!==i&&console.error(i)}initGpgpuBirds(){const t=(t=>{const e=new a.BufferGeometry;t.quantity&&(h=Math.pow(2,t.quantity),d=h*h);const i=3*d,o=3*i,n=new a.BufferAttribute(new Float32Array(3*o),3),s=new a.BufferAttribute(new Float32Array(3*o),3),r=new a.BufferAttribute(new Float32Array(2*o),2),l=new a.BufferAttribute(new Float32Array(o),1);e.setAttribute||(e.setAttribute=e.addAttribute),e.setAttribute("position",n),e.setAttribute("birdColor",s),e.setAttribute("reference",r),e.setAttribute("birdVertex",l);let c=0;const u=function(){for(let t=0;t<arguments.length;t++)n.array[c++]=arguments[t]},p=t.wingSpan||20,m=t.birdSize||1;for(let t=0;t<d;t++)u(0,-0,-20*m,0,4*m,-20*m,0,0,30*m),u(0,0,-15*m,-p*m,0,0,0,0,15*m),u(0,0,15*m,p*m,0,0,0,0,-15*m);const f={};for(c=0;c<3*i;c++){const e=~~(~~(c/3)/3),i=e%h/h,o=~~(e/h)/h,n=~~(c/9)/d,a=n.toString(),u=-1!=t.colorMode.indexOf("Gradient");let p;p=!u&&f[a]?f[a]:t.effect.getNewCol(n),u||f[a]||(f[a]=p),s.array[3*c+0]=p.r,s.array[3*c+1]=p.g,s.array[3*c+2]=p.b,r.array[2*c]=i,r.array[2*c+1]=o,l.array[c]=c%9}return e.scale(.2,.2,.2)})(Object.assign({},this.options,{effect:this}));this.birdUniforms={color:{value:new a.Color(16720384)},texturePosition:{value:null},textureVelocity:{value:null},time:{value:1},delta:{value:0},birdSize:{value:this.options.birdSize}};const e=new a.ShaderMaterial({uniforms:this.birdUniforms,vertexShader:"attribute vec2 reference;\nattribute float birdVertex;\n\nattribute vec3 birdColor;\n\nuniform sampler2D texturePosition;\nuniform sampler2D textureVelocity;\n\nvarying vec4 vColor;\nvarying float z;\n\nuniform float time;\nuniform float birdSize;\n\nvoid main() {\n\n  vec4 tmpPos = texture2D( texturePosition, reference );\n  vec3 pos = tmpPos.xyz;\n  vec3 velocity = normalize(texture2D( textureVelocity, reference ).xyz);\n\n  vec3 newPosition = position;\n\n  if ( birdVertex == 4.0 || birdVertex == 7.0 ) {\n    // flap wings\n    newPosition.y = sin( tmpPos.w ) * 5. * birdSize;\n  }\n\n  newPosition = mat3( modelMatrix ) * newPosition;\n\n  velocity.z *= -1.;\n  float xz = length( velocity.xz );\n  float xyz = 1.;\n  float x = sqrt( 1. - velocity.y * velocity.y );\n\n  float cosry = velocity.x / xz;\n  float sinry = velocity.z / xz;\n\n  float cosrz = x / xyz;\n  float sinrz = velocity.y / xyz;\n\n  mat3 maty =  mat3(\n    cosry, 0, -sinry,\n    0    , 1, 0     ,\n    sinry, 0, cosry\n  );\n\n  mat3 matz =  mat3(\n    cosrz , sinrz, 0,\n    -sinrz, cosrz, 0,\n    0     , 0    , 1\n  );\n  newPosition =  maty * matz * newPosition;\n  newPosition += pos;\n  z = newPosition.z;\n\n  vColor = vec4( birdColor, 1.0 );\n  gl_Position = projectionMatrix *  viewMatrix  * vec4( newPosition, 1.0 );\n}",fragmentShader:"varying vec4 vColor;\nvarying float z;\nuniform vec3 color;\nvoid main() {\n  // Fake colors for now\n  float rr = 0.2 + ( 1000. - z ) / 1000. * vColor.x;\n  float gg = 0.2 + ( 1000. - z ) / 1000. * vColor.y;\n  float bb = 0.2 + ( 1000. - z ) / 1000. * vColor.z;\n  gl_FragColor = vec4( rr, gg, bb, 1. );\n}",side:a.DoubleSide}),i=new a.Mesh(t,e);return i.rotation.y=Math.PI/2,i.matrixAutoUpdate=!1,i.updateMatrix(),this.scene.add(i)}getNewCol(t){const e=this.options,i=null!=e.color1?e.color1:4456448,o=null!=e.color2?e.color2:6684672,n=new a.Color(i),s=new a.Color(o);let r,l;if(l=-1!=e.colorMode.indexOf("Gradient")?Math.random():t,0==e.colorMode.indexOf("variance")){const t=(n.r+Math.random()*s.r).clamp(0,1),e=(n.g+Math.random()*s.g).clamp(0,1),i=(n.b+Math.random()*s.b).clamp(0,1);r=new a.Color(t,e,i)}else r=0==e.colorMode.indexOf("mix")?new a.Color(i+l*o):n.lerp(s,l);return r}onInit(){this.camera=new a.PerspectiveCamera(75,this.width/this.height,1,3e3),this.camera.position.z=350,this.fog=new a.Fog(16777215,100,1e3),this.mouseX=this.mouseY=0;const t=this.birds=[],e=this.boids=[],i=this.options;let o,n;if(l)try{this.initComputeRenderer(),this.valuesChanger=this.valuesChanger.bind(this),this.valuesChanger(),this.initGpgpuBirds()}catch(t){console.error("[vanta.js] birds init error: ",t)}else{const l=6*Math.pow(2,i.quantity);for(var s=0;s<l;s++){o=e[s]=new p(i),o.position.x=400*Math.random()-200,o.position.y=400*Math.random()-200,o.position.z=400*Math.random()-200,o.velocity.x=2*Math.random()-1,o.velocity.y=2*Math.random()-1,o.velocity.z=2*Math.random()-1,o.setWorldSize(500,500,300);const d=-1!=i.colorMode.indexOf("Gradient"),c=u(i),m=c.attributes.position.length,f=new a.BufferAttribute(new Float32Array(m),3);if(d)for(var r=0;r<c.index.array.length;r+=3)for(var h=0;h<=2;h++){const t=c.index.array[r+h],e=this.getNewCol();f.array[3*t]=e.r,f.array[3*t+1]=e.g,f.array[3*t+2]=e.b}else{const t=this.getNewCol(s/l);for(r=0;r<f.array.length;r+=3)f.array[r]=t.r,f.array[r+1]=t.g,f.array[r+2]=t.b}c.setAttribute("color",f),n=t[s]=new a.Mesh(c,new a.MeshBasicMaterial({color:16777215,side:a.DoubleSide,vertexColors:a.VertexColors})),n.phase=Math.floor(62.83*Math.random()),n.position.x=e[s].position.x,n.position.y=e[s].position.y,n.position.z=e[s].position.z,this.scene.add(n)}}}valuesChanger(){this.velocityUniforms&&(this.velocityUniforms.separationDistance.value=this.options.separation,this.velocityUniforms.alignmentDistance.value=this.options.alignment,this.velocityUniforms.speedLimit.value=this.options.speedLimit,this.velocityUniforms.cohesionDistance.value=this.options.cohesion)}onUpdate(){this.now=performance.now(),this.last||(this.last=this.now);let t=(this.now-this.last)/1e3;if(t>1&&(t=1),this.last=this.now,l)this.positionUniforms.time.value=this.now,this.positionUniforms.delta.value=t,this.velocityUniforms.time.value=this.now,this.velocityUniforms.delta.value=t,this.birdUniforms.time.value=this.now,this.birdUniforms.delta.value=t,this.velocityUniforms.predator.value.set(this.mouseX,-this.mouseY,0),this.mouseX=1e4,this.mouseY=1e4,this.gpuCompute.compute(),this.birdUniforms.texturePosition.value=this.gpuCompute.getCurrentRenderTarget(this.positionVariable).texture,this.birdUniforms.textureVelocity.value=this.gpuCompute.getCurrentRenderTarget(this.velocityVariable).texture;else{const t=this.birds,o=this.boids;let n,s;for(var e=0,i=t.length;e<i;e++){n=o[e],n.run(o),s=t[e],s.rotation.y=Math.atan2(-n.velocity.z,n.velocity.x),s.rotation.z=Math.asin(n.velocity.y/n.velocity.length()),s.phase=(s.phase+(Math.max(0,s.rotation.z)+.1))%62.83;const i=16,r=13;s.geometry.attributes.position.array[i]=s.geometry.attributes.position.array[r]=5*Math.sin(s.phase)*this.options.birdSize,s.geometry.attributes.position.needsUpdate=!0,s.geometry.computeVertexNormals(),s.position.x=o[e].position.x,s.position.y=o[e].position.y,s.position.z=o[e].position.z}}}onMouseMove(t,e){if(this.mouseX=t-.5,this.mouseY=e-.5,!l){const t=this.boids;let e;for(var i=new a.Vector3(this.mouseX*this.width,-this.mouseY*this.height,0),o=0,n=t.length;o<n;o++)e=t[o],i.z=e.position.z,e.repulse(i)}}onDestroy(){}onResize(){}}m.initClass();const f=t.o.register("BIRDS",m)})(),o})()));